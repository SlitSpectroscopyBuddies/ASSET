var documenterSearchIndex = {"docs":
[{"location":"#ASSET-Documentation","page":"ASSET Documentation","title":"ASSET Documentation","text":"Pages = [\"documentation.md\",\"estimation.md\"]\n\nlink to ASSET.AbstractBkg\nlink to ASSET.BkgMdl\n\n","category":"section"},{"location":"#Theoretical-Background","page":"ASSET Documentation","title":"Theoretical Background","text":"The method used in the ASSET package requires the following maps as inputs: \n\ndata maps (d_ell)_ell in 1L, where L is the amount of dithers/acquisitions/frames;\nweights maps w_ell, where each element can be computed as the inverse variance of the pixel, forming the matrix W_ell= Sigma_ell^-2. We assume that a defective pixel or artifacts have an infinite variance, i.e. a zero entry in W_ell;\nspatial coordinate maps X_ell where 0 should correspond to the center of the studied object;\nspectral coordinate maps Lambda_ell.\n\nThe method outputs are the extracted spectrum z, sampled over a given regular wavelength grid (lambda_n)_n in 1N, and the parameters theta of the fitted PSF model. They are obtained by solving:  \n\n( z,\\theta \\in \\mathrm{arg min} \\Big{\\sum\\ell\\Vert d\\ell - (m\\ell(z,\\theta) + b)\\Vert{W{\\ell}}^2 + \\muz\\mathcal{R}z(z) + \\mu\\theta\\mathcal{R}\\theta(\\theta) + \\mub\\mathcal{R}b(b), \\Big} ) where \\mathcal{R}z mathcalR_theta and mathcalR_b are respectively the regularization of the extracted spectra, of the PSF parameters if required and of the background, with hyperparameters mu_z, mu_theta and mu_b. The spatial distribution maps X and the background map b are auto-calibrated in the process.  The model of the data\n\n( m\\ell(z,\\theta) = \\alpha\\ell Z(\\Lambda\\ell,z) \\odot H(\\theta, X\\ell, \\Lambda_\\ell))\n\nis the Hadamard (element-wise) product of the spectrum interpolated in the camera plane\n\n( Z(\\Lambda,z){j,k}=\\sumn\\phi\\Big(\\frac{\\Lambda{j,k}-\\lambdan}{\\delta\\lambda}\\Big)zn )\n\nwith phi an interpolation kernel, and of the chromatic PSF H (parametric or non-parametric). The package provide several ParametricPSF and NonParametricPSF and the users can easily implement their own. A ParametricPSF  H is a function parametrized by a few unknown variables theta_m, thus with low degrees of freedom, e.g. a Gaussian chromatic with a minimum width model: ( H(\\theta, X\\ell, \\Lambda\\ell){j,k} = \\big(2 \\pi(\\theta1 \\Lambda{j,k\\ell}^2 + \\theta2)\\big)^{-1}\\exp\\Big(-\\frac{X{j,k,\\ell}^2}{2(\\theta1\\Lambda{j,k,\\ell}^2+\\theta2)}\\Big). )\n\nIt does not require any regularization. See @The:2023 and @Denneulin:2023 for more details. \n\nA NonParametricPSF is parametrized directly by some profile (theta_m)_m in  1M, thus with high degrees of freedom , e.g. taking o order of the speckles expansion model [@Devaney:2017] which is the interpolation of the profiles theta_o in a reference plane of the spatial coordinates (x_m)_m in 1M,:\n\n( H(\\theta, X\\ell, \\Lambda\\ell){j,k} = \\sumo \\gamma(\\Lambda\\ell)^o \\summ \\phi\\Big(\\frac{\\gamma(\\Lambda\\ell)X\\ell - xm}{\\delta x}\\Big)\\theta{m,o}(x_m). )\n\nFor such a PSF, theta must be regularized. The hyperparameter is auto-calibrated in the method (see @The:2023 for and references therein for more details). ","category":"section"},{"location":"#ASSET.AbstractBkg","page":"ASSET Documentation","title":"ASSET.AbstractBkg","text":"AbstractBkg\n\nType that defines a background structure, that is used to specify a certain model of the background present in the data and its associated regularization. This structure is used when one want to both estimate the background sources of the data and extracting the spectrum of the object of interest.\n\nTo define a structure B of type AbstractBkg, the user needs to overload three methods:\n\njulia> get_bkg(B)\n\nwhich yields the background as an AbstractArray from parameters contained in B.\n\njulia> regul(B)\n\nwhich yields the result of the regularization term(s), applied to the curent background model, that are used in the a posteriori likelihood minimization.\n\njulia> fit_bkg!(B, D)\n\nwhere D is a CalibratedData. This last function is the one called by extract_spectrum to estimate the background when assuming the object spectrum known (alternate estimation). \n\nSee also\n\nBkgMdl\n\n\n\n\n\n","category":"type"},{"location":"#ASSET.BkgMdl","page":"ASSET Documentation","title":"ASSET.BkgMdl","text":"BkgMdl(b, R)\n\nyields a structure of type AbstractBkg, composed of an AbstractArray b and an associated regularization R of type Regularization.\n\nExample\n\n# create a BkgMdl structure\njulia> B = BkgMdl(b, R)\n# add the structure to an AbstractArray\njulia> A = ones(size(b))\njulia> A + B\n\nTo apply the regularization to the background array:\n\njulia> regul(B)\n\nTo fit the background to some CalibratedData D:\n\njulia> fit_bkg!(B, D, true, kwds...)\n\nwhere kwds specifies all the keywords used by the optimization method to estimate the background.\n\nSee also\n\nAbstractBkg\n\n\n\n\n\n","category":"type"},{"location":"#ASSET.extract_spectrum!","page":"ASSET Documentation","title":"ASSET.extract_spectrum!","text":"extract_spectrum!(z, F, psf, D, Reg [, Bkg]; kwds...)\n\nestimates the spectrum of an object observed with long-slit spectroscopy, when the data can be corrupted by a background component and noise. The direct model of such data can be writen: d = Bkg + Diag(H)*F*z + n where * the matrix product. z is the spectrum of the object of interest and F its associated interpolation operator, H the operator modeling the Point Spread Function (PSF) of the instrument, while Bkg is the background component to disentangle from the object of interest and n accounts for noises.\n\nThe data and there associated weights are given by the CalibratedData structure D, while the array H is produced using the method psf_map with the arguments psf and psf_center.\n\nThe estimation of the different unknowns relies on the minimization of the a posteriori likelihood, where Reg is the regularization function of z (of type InverseProblem.Regularization) and where Bkg is a structure of type AbstractBkg, which contains a way to produce the background component and its regularization function. If Bkg is not given, the algorithm will suppose that there is no background in the data and will only call fit_spectrum_and_psf!. If there is a Bkg given, the algorithm will alternate the estimation of the background using fit_bkg! with the extraction of the spectrum (done in fit_spectrum_and_psf!).\n\nFinally, an auto-calibration step can be activated which will refine the parameters and center of the PSF.\n\nKeywords\n\nauto_calib : (Val(true) by default) precise if an auto-calibration step of the PSF must be done after extracting the spectrum. It can also take the value Val(:delay) which will run the algorithm without autocalib until it converges, before activating the `autocalib` and re-running the algorithm.\nmask_width : (3 by default) defines the number of fwhm of the psf will be used to hide the object on the first iteration of the background estimtion (if thee is one).\nmax_iter : (1000 by default) defines the maximum number of iterations that can do the method (useful when auto_calib=true).\nloss_tol : ((0,1e-6) by default) defines the absolute and relative tolerance between two consecutive iteration of the loss function as a stop criterion.\nz_tol : ((0,1e-6) by default) defines the absolute and relative tolerance between two consecutive iteration of the estimate z as a stop criterion.\nextract_kwds : ((verb=true,) by default) where other keywords can be given which are forwarded to the object_step method. \n\nSee also\n\nAbstractBkg\n[PointSpreadFunctions.AbstractPSF]\n\n\n\n\n\n","category":"function"},{"location":"#ASSET.ChromaticSeriesExpansionsInterpolator","page":"ASSET Documentation","title":"ASSET.ChromaticSeriesExpansionsInterpolator","text":"struct ChromaticSeriesExpansionsInterpolator <: LinearMapping\n\nA structure representing a chromatic series expansions interpolator, which performs linear mapping operations for chromatic data interpolation. \n\nArguments\n\ncols: Tuple specifying the number of columns (output dimensions). \nrows: Tuple specifying the number of rows (input dimensions).\nker: Kernel object used for interpolation.\nX: Array of input positions.\nΛ: Array of wavelength or chromatic values.\nx: Range of positions for interpolation.\nλref: Reference wavelength for normalization.\na: Parameter for scaling or regularization.\n\n\n\nChromaticSeriesExpansionsInterpolator{T}(ker::Kernel, X::AbstractArray{T,N}, Λ::AbstractArray{T,N}, x::AbstractRange; order=1, λref=maximum(Λ), a=0.)\n\nConstructs a ChromaticSeriesExpansionsInterpolator with specified kernel, input arrays, and interpolation range. Optionally specify the interpolation order, reference wavelength, and scaling parameter. \n\nArguments\n\nker: Interpolation kernel.\nX: Input position array.\nΛ: Input wavelength/chromatic array.\nx: Range of positions for interpolation.\norder: Interpolation order (default: 1).\nλref: Reference wavelength (default: maximum of Λ).\na: Scaling parameter (default: 0).\n\n\n\nChromaticSeriesExpansionsInterpolator(ker::Kernel, X::AbstractArray{<:Any,N}, Λ::AbstractArray{<:Any,N}, x::AbstractRange; order=1, λref=maximum(Λ), a=0.)\n\nConstructs a ChromaticSeriesExpansionsInterpolator with type promotion to Float64 for the input arrays.\n\n\n\n\n\n","category":"type"},{"location":"#ASSET.CalibratedData","page":"ASSET Documentation","title":"ASSET.CalibratedData","text":"struct CalibratedData{T<:AbstractFloat, N, D<:AbstractArray{T,N}}\n\nA container for storing calibrated scientific data and associated weights  w, the angular separation ρ_map and wavelength λ_map maps calibrating the detector.\n\nArguments\n\nd::D: The main scientific data array.\nw::D: The weight array corresponding to the data.\nρ_map::D: The spatial map associated with the data.\nλ_map::D: The spectral map associated with the data.\n\nThe Base methods axes, size, eltype and show have been overload to be used with such a structure.\n\n\n\n\n\n","category":"type"}]
}
